/*! flickr_feed_viewer 20-06-2016 */
angular.module("flickv.controllers",["restangular"]),angular.module("flickv.directives",[]);var flickrViewer=angular.module("flickrViewer",["ngRoute","flickv.controllers","flickv.directives"]);flickrViewer.run(function(){}),flickrViewer.config(["$routeProvider",function($routeProvider){$routeProvider.when("/feeds",{templateUrl:"feed-viewer/feed-viewer.tmpl.html",controller:"FeedViewerController"}).when("/",{templateUrl:"home/home.tmpl.html"}).otherwise({redirectTo:"/"})}]),flickvDirectivesModule=angular.module("flickv.directives"),flickvDirectivesModule.directive("flickvCell",[function(){return{restrict:"AE",templateUrl:"/components/cell/cell.tmpl.html",link:function(scope,element,attrs){var ngModel=scope[attrs.cellModel];attrs.cellSourceAttr&&ngModel[attrs.cellSourceAttr]?scope.imgSrc=ngModel[attrs.cellSourceAttr]:scope.imgSrc="/images/no-image.png",attrs.cellNameAttr&&ngModel[attrs.cellNameAttr]?scope.imageName=ngModel[attrs.cellNameAttr]:scope.imageName="",attrs.cellTagsAttr&&ngModel[attrs.cellTagsAttr]?scope.tags=ngModel[attrs.cellTagsAttr]:scope.tags=""}}}]),flickvDirectivesModule=angular.module("flickv.directives"),flickvDirectivesModule.directive("flickvSearch",function(){return{replace:!0,templateUrl:"/components/search-box/search-box.tmpl.html",restrict:"E",scope:{searchSubmit:"&",clearSearchCallBack:"&"},link:function(scope,elem,attrs){scope.searchValues=null,scope.selectedValue=null,scope.searchBoxPaddingLeft=0,scope.searchBoxPaddingTop=0,scope.clearSearch=function(){scope.selectedValue=void 0,scope.searchValues=[],scope.searchBoxPaddingLeft=0,scope.searchBoxPaddingTop=0,scope.clearSearchCallBack({})},elem.find("#attrVal").bind("keydown keypress",function(event){13===event.which&&scope.selectedValue&&(scope.$apply(function(){scope.searchValues?scope.searchValues.push(scope.selectedValue):(scope.searchValues=[],scope.searchValues.push(scope.selectedValue)),scope.searchBoxPaddingLeft+5*scope.selectedValue.length+51+80>450?(scope.searchBoxPaddingLeft=0,scope.searchBoxPaddingTop+=40):scope.searchBoxPaddingLeft+=5*scope.selectedValue.length+51,scope.selectedValue=void 0}),scope.searchSubmit({$searchValues:scope.searchValues}),event.preventDefault())}),elem.on("click",function(){elem.find("#attrVal").focus()}),scope.removeTerm=function(index){scope.searchValues&&scope.searchValues.length>index&&(scope.searchValues.splice(index,1),scope.searchSubmit({$searchValues:scope.searchValues}))}}}}),flickvControllersModule=angular.module("flickv.controllers"),flickvControllersModule.controller("FeedViewerController",["$scope","Restangular",function($scope,Restangular){$scope.fieldName={NAME:"name",SOURCE:"source",TAGS:"tags"},$scope.viewGrid=!0,$scope.imageList=null,$scope.serverError=null,$scope.searchSubmit=function(searchTags){var searchTerm="";$scope.imageList=null,$scope.serverError=null,searchTerm=searchTags.length>0?encodeURI(searchTags.toString()):-1,Restangular.one("api/feeds/"+searchTerm).get().then(function(data){200==data.status?$scope.imageList=data.feeds:500==data.status&&($scope.serverError=data.error)})},$scope.searchSubmit([])}]);